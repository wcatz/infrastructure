---
# Default variables for k3s role

# k3s version - update as needed
# Check latest releases: https://github.com/k3s-io/k3s/releases
k3s_version: "v1.28.5+k3s1"
k3s_install_url: "https://get.k3s.io"

# Disable Traefik and servicelb for hybrid cluster with Tailscale networking
k3s_server_args:
  - "--disable=traefik"
  - "--disable=servicelb"
  - "--write-kubeconfig-mode=644"
  - "--flannel-backend=none"
  - "--disable-network-policy"

# Components disabled for hybrid cluster:
# - traefik: Using Cloudflared for HTTP/S ingress
# - servicelb: Using NodePort/hostNetwork for TCP exposure
# - flannel: Using Tailscale for node-to-node networking
# - network-policy: Tailscale handles network security

# Node labels for workload placement
k3s_node_labels: []
# Example for control plane at home (behind CGNAT):
# k3s_node_labels:
#   - "node-role.kubernetes.io/control-plane=true"
#   - "topology.kubernetes.io/zone=home"
# Example for worker at Netcup (public IP):
# k3s_node_labels:
#   - "node-role.kubernetes.io/worker=true"
#   - "topology.kubernetes.io/zone=netcup"

# k3s token for agent nodes (generate with: openssl rand -hex 32)
# This references the encrypted vault variable
k3s_token: "{{ vault_k3s_token }}"

# Server node configuration
k3s_server_enabled: true
k3s_agent_enabled: false

# Hybrid cluster configuration
# Apply taint to control plane to prevent workload scheduling
# Set to true for control plane nodes behind CGNAT
k3s_node_taint: false

# Node labels for worker nodes
# Example: k3s_node_label: "node-role=worker,workload-type=general"
# k3s_node_label: ""

# Network configuration
k3s_cluster_cidr: "10.42.0.0/16"
k3s_service_cidr: "10.43.0.0/16"
k3s_cluster_dns: "10.43.0.10"

# TLS SAN (additional hostnames/IPs for the certificate)
k3s_tls_san: []
# Example:
# k3s_tls_san:
#   - "k3s.example.com"
#   - "192.168.1.100"
